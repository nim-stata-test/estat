
        <h2 id="heating-curve">8. Heating Curve Analysis</h2>

        <div class="card">
            <h4>Model Overview</h4>
            <p>The target flow temperature for heating circuit 1 (HK1) follows a linear heating curve formula:</p>
            <pre style="background: var(--card-bg); color: var(--text); padding: 0.5rem;">T_target = T_setpoint + curve_rise × (T_ref - T_outdoor)</pre>

            <h4>Parameters</h4>
            <table>
                <tr><th>Parameter</th><th>Description</th><th>Value</th></tr>
                <tr>
                    <td><strong>T_setpoint</strong></td>
                    <td>Room temperature setpoint (comfort or eco depending on schedule)</td>
                    <td>Comfort: 20.3°C, Eco: 18.0°C</td>
                </tr>
                <tr>
                    <td><strong>curve_rise</strong></td>
                    <td>Heating curve slope (controllable parameter)</td>
                    <td>1.08 (range: 0.85 - 1.14)</td>
                </tr>
                <tr>
                    <td><strong>T_ref</strong></td>
                    <td>Internal reference temperature (derived from data)</td>
                    <td>Comfort: 21.34°C, Eco: 19.16°C</td>
                </tr>
                <tr>
                    <td><strong>T_outdoor</strong></td>
                    <td>Outdoor temperature sensor</td>
                    <td>Range: -3.8°C to 15.1°C</td>
                </tr>
            </table>
        </div>

        <div class="card">
            <h4>Schedule Regimes (Detected from Data)</h4>
            <p>The comfort/eco schedule was detected by analyzing step changes (>3°C) in the target temperature.
            The system automatically switches between comfort (higher setpoint) during the day and eco (lower setpoint) at night.</p>
            <table>
                <tr><th>Period</th><th>Comfort Start</th><th>Comfort End</th><th>Duration</th><th>Days</th></tr>
                <tr>
                    <td>2025-10-30 to 2025-12-26</td>
                    <td>06:30</td>
                    <td>20:00</td>
                    <td>13.5 hours</td>
                    <td>46</td>
                </tr>
                <tr>
                    <td>2025-12-27 to 2026-01-07</td>
                    <td>06:30</td>
                    <td>21:30</td>
                    <td>15.0 hours</td>
                    <td>10</td>
                </tr>
                <tr>
                    <td>2026-01-08 to 2026-01-08</td>
                    <td>06:30</td>
                    <td>09:00</td>
                    <td>2.5 hours</td>
                    <td>1</td>
                </tr>
                <tr>
                    <td>2026-01-09 to 2026-01-13</td>
                    <td>06:30</td>
                    <td>21:30</td>
                    <td>15.0 hours</td>
                    <td>3</td>
                </tr>
                <tr>
                    <td>2026-01-16 to 2026-01-16</td>
                    <td>06:00</td>
                    <td>21:30</td>
                    <td>15.5 hours</td>
                    <td>1</td>
                </tr>

            </table>
            <p><em>Note: Times are in local timezone (Europe/Zurich). Comfort mode uses the higher setpoint;
            eco mode (outside comfort hours) uses the lower setpoint.</em></p>
        </div>

        <div class="card">
            <h4>Setpoint Regimes (Time-Varying Setpoints)</h4>
            <p>The comfort and eco temperature setpoints change over time. These changes affect the target flow temperature
            independently of the daily schedule. Notable: eco=30°C effectively disables eco mode (24h comfort).</p>
            <table>
                <tr><th>Start Date</th><th>Comfort (°C)</th><th>Eco (°C)</th><th>RMSE (°C)</th><th>Notes</th></tr>
                <tr>
                    <td>2025-10-28 17:25</td>
                    <td>20.5</td>
                    <td>nan</td>
                    <td>1.04</td>
                    <td></td>
                </tr>
                <tr>
                    <td>2025-10-28 17:25</td>
                    <td>20.5</td>
                    <td>18.7</td>
                    <td>1.04</td>
                    <td></td>
                </tr>
                <tr>
                    <td>2025-10-29 07:39</td>
                    <td>20.5</td>
                    <td>18.5</td>
                    <td>0.41</td>
                    <td></td>
                </tr>
                <tr>
                    <td>2025-10-29 10:35</td>
                    <td>20.5</td>
                    <td>18.3</td>
                    <td>0.69</td>
                    <td></td>
                </tr>
                <tr>
                    <td>2025-11-03 00:07</td>
                    <td>20.3</td>
                    <td>18.3</td>
                    <td>0.55</td>
                    <td></td>
                </tr>
                <tr>
                    <td>2025-11-04 15:09</td>
                    <td>20.2</td>
                    <td>18.3</td>
                    <td>0.50</td>
                    <td>Standard</td>
                </tr>
                <tr>
                    <td>2025-11-04 15:09</td>
                    <td>20.2</td>
                    <td>18.2</td>
                    <td>0.50</td>
                    <td>Standard</td>
                </tr>
                <tr>
                    <td>2025-11-25 23:55</td>
                    <td>20.2</td>
                    <td>18.0</td>
                    <td>0.50</td>
                    <td>Standard</td>
                </tr>
                <tr>
                    <td>2025-12-04 15:48</td>
                    <td>20.2</td>
                    <td>30.0</td>
                    <td>5.09</td>
                    <td>Eco disabled (24h comfort)</td>
                </tr>
                <tr>
                    <td>2025-12-07 09:59</td>
                    <td>20.2</td>
                    <td>18.0</td>
                    <td>0.36</td>
                    <td>Standard</td>
                </tr>
                <tr>
                    <td>2025-12-14 10:23</td>
                    <td>20.5</td>
                    <td>18.0</td>
                    <td>0.60</td>
                    <td></td>
                </tr>
                <tr>
                    <td>2025-12-25 14:25</td>
                    <td>20.7</td>
                    <td>18.0</td>
                    <td>0.78</td>
                    <td></td>
                </tr>
                <tr>
                    <td>2025-12-27 10:29</td>
                    <td>21.0</td>
                    <td>18.0</td>
                    <td>0.66</td>
                    <td>Higher comfort</td>
                </tr>
                <tr>
                    <td>2025-12-30 22:22</td>
                    <td>20.7</td>
                    <td>18.0</td>
                    <td>1.10</td>
                    <td></td>
                </tr>
                <tr>
                    <td>2025-12-31 10:27</td>
                    <td>21.0</td>
                    <td>18.0</td>
                    <td>1.55</td>
                    <td>Higher comfort</td>
                </tr>
                <tr>
                    <td>2026-01-12 10:01</td>
                    <td>23.0</td>
                    <td>18.0</td>
                    <td>2.32</td>
                    <td>Higher comfort</td>
                </tr>
                <tr>
                    <td>2026-01-12 10:01</td>
                    <td>23.0</td>
                    <td>15.0</td>
                    <td>2.32</td>
                    <td>Higher comfort</td>
                </tr>
                <tr>
                    <td>2026-01-13 23:05</td>
                    <td>23.0</td>
                    <td>14.0</td>
                    <td>3.78</td>
                    <td>Higher comfort</td>
                </tr>
                <tr>
                    <td>2026-01-13 23:21</td>
                    <td>21.0</td>
                    <td>14.0</td>
                    <td>3.78</td>
                    <td>Higher comfort</td>
                </tr>
                <tr>
                    <td>2026-01-17 12:21</td>
                    <td>20.5</td>
                    <td>14.0</td>
                    <td>2.03</td>
                    <td></td>
                </tr>
                <tr>
                    <td>2026-01-17 12:21</td>
                    <td>20.5</td>
                    <td>17.0</td>
                    <td>2.03</td>
                    <td></td>
                </tr>

            </table>
        </div>

        <div class="card">
            <h4>Model Performance</h4>
            <table>
                <tr><td>R-squared</td><td><strong>0.9207</strong> (explains 92.1% of variance)</td></tr>
                <tr><td>RMSE (overall)</td><td>1.28°C</td></tr>
                <tr><td>RMSE (comfort mode)</td><td>0.52°C</td></tr>
                <tr><td>RMSE (eco mode)</td><td>1.45°C</td></tr>
            </table>

            <h4>Parameter Effects</h4>
            <ul>
                <li><strong>Setpoint</strong>: +1°C setpoint → +1°C target flow temperature (direct relationship)</li>
                <li><strong>Curve rise</strong>: +0.1 rise → +1.6°C target at 5°C outdoor, +2.1°C at 0°C outdoor</li>
                <li><strong>Outdoor temperature</strong>: +1°C outdoor → -1.08°C target (inverse relationship via curve)</li>
            </ul>
        </div>

        <div class="card">
            <h4>Example Calculations</h4>
            <p>For outdoor temperature = 5°C, comfort_temp = 20.3°C, eco_temp = 18.0°C, curve_rise = 1.08:</p>
            <table>
                <tr><th>Outdoor</th><th>Comfort Target</th><th>Eco Target</th></tr>
                <tr><td>-3°C</td><td>46.6°C</td><td>41.9°C</td></tr>
                <tr><td>0°C</td><td>43.3°C</td><td>38.7°C</td></tr>
                <tr><td>5°C</td><td>37.9°C</td><td>33.3°C</td></tr>
                <tr><td>10°C</td><td>32.5°C</td><td>27.9°C</td></tr>
                <tr><td>15°C</td><td>27.1°C</td><td>22.5°C</td></tr>
            </table>
        </div>

        <div class="figure">
            <img src="fig2.12_heating_curve_schedule.png" alt="Heating curve analysis with schedule detection">
            <div class="figure-caption">Fig 12: Heating curve analysis (all data): setpoint regimes (top-left), target vs outdoor temperature colored by setpoint (top-right),
            model residuals by hour (bottom-left), and model summary (bottom-right)</div>
        </div>

        <div class="figure">
            <img src="fig2.12a_heating_curve_censored.png" alt="Heating curve analysis excluding anomalous periods">
            <div class="figure-caption">Fig 12a: Heating curve analysis (censored): excluding anomalous periods where eco >= comfort.
            Shows residual distribution (top-left), target vs outdoor (top-right), predicted vs actual (bottom-left), and summary stats (bottom-right).
            R² = 0.9460, RMSE = 1.02°C for normal operation.</div>
        </div>
