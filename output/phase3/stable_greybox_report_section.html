
    <section id="stable-greybox-model">
    <h2>3.1c Stability-Constrained Grey-Box Model</h2>

    <div style="background-color: #d4edda; border: 1px solid #28a745; padding: 15px; margin-bottom: 20px; border-radius: 5px;">
        <strong>Model Status: STABLE</strong><br>
        Max eigenvalue: 0.9938 (threshold: 0.998)<br>
        Forward simulation R² = 0.582, RMSE = 0.57°C
    </div>

    <h3>Key Improvements</h3>
    <ol>
        <li><strong>Eigenvalue stability constraint</strong>: Parameters optimized to ensure max|λ| &lt; 0.998</li>
        <li><strong>Semi-implicit integration</strong>: Unconditionally stable for diagonal decay terms</li>
        <li><strong>Kalman filter option</strong>: State correction when observations available</li>
        <li><strong>Two-phase optimization</strong>: First one-step, then forward simulation</li>
    </ol>

    <h3>Estimated Parameters</h3>
    <table>
        <tr><th>Parameter</th><th>Value</th><th>Physical Meaning</th></tr>
        <tr><td>τ_buf</td><td>1.00 h</td><td>Buffer tank time constant</td></tr>
        <tr><td>τ_room</td><td>78.2 h</td><td>Building time constant</td></tr>
        <tr><td>r_emit</td><td>1.090</td><td>Emitter coupling ratio</td></tr>
        <tr><td>r_heat</td><td>2.000</td><td>Heat transfer ratio</td></tr>
        <tr><td>k_solar</td><td>0.0400 K/kWh</td><td>Solar gain coefficient</td></tr>
        <tr><td>c_offset</td><td>-0.0542 K/h</td><td>Temperature drift correction</td></tr>
    </table>

    <h3>Forward Simulation Performance</h3>
    <table>
        <tr><th>Metric</th><th>Value</th><th>Interpretation</th></tr>
        <tr>
            <td><strong>R² (forward sim)</strong></td>
            <td><strong>0.582</strong></td>
            <td>Moderate</td>
        </tr>
        <tr>
            <td>RMSE (forward sim)</td>
            <td>0.57°C</td>
            <td>Average prediction error</td>
        </tr>
        <tr>
            <td>Bias (forward sim)</td>
            <td>-0.00°C</td>
            <td>Systematic over/under-prediction</td>
        </tr>
    </table>

    <h3>Kalman Filter Performance</h3>
    <p>When observations are available, the Kalman filter corrects predictions:</p>
    <table>
        <tr><th>Metric</th><th>Value</th></tr>
        <tr><td>R² (Kalman)</td><td>0.606</td></tr>
        <tr><td>RMSE (Kalman)</td><td>0.55°C</td></tr>
    </table>

    <h3>Stability Analysis</h3>
    <p>The state transition matrix A has eigenvalues:</p>
    <ul>
        <li>λ₁ = 0.4741</li>
        <li>λ₂ = 0.9938</li>
        <li>Max |λ| = 0.9938 &lt; 0.998 ✓</li>
    </ul>

    <figure>
        <img src="fig18c_stable_greybox_model.png" alt="Stable Grey-Box Model Results">
        <figcaption><strong>Figure 18c:</strong> Stability-constrained grey-box model with eigenvalue
        constraints. Top: forward simulation and Kalman filter vs actual. Bottom: residuals,
        eigenvalue plot, and model comparison.</figcaption>
    </figure>
    </section>
    